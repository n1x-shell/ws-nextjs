@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --phosphor-green: #33ff33;
  --phosphor-rgb:   51, 255, 51;       
  --terminal-bg: #0a0a0a;
  --glow: #33ff33;
  --monitor-bezel: #1a1a1a;

  --text-base:   10px;   /* ~10pt -- body / terminal output */
  --text-header: 12px;   /* ~12pt -- section headings       */
}

/* Phosphor spectrum shifts */
/* Managed by useFrequencyShift + phosphor command                             */

/* Amber / Orange -- P3 phosphor */
.amber-shift {
  --phosphor-green: #FFB000;
  --phosphor-rgb:   255, 176, 0;
  --glow:           #FFB000;
}

/* Violet / Purple -- synthetic spectrum */
.violet-shift {
  --phosphor-green: #B44FFF;
  --phosphor-rgb:   180, 79, 255;
  --glow:           #B44FFF;
}

/* White -- P4 phosphor, clinical blue-white */
.white-shift {
  --phosphor-green: #E8F4F8;
  --phosphor-rgb:   232, 244, 248;
  --glow:           #E8F4F8;
}

/* Blue -- P7 phosphor, military/surveillance */
.blue-shift {
  --phosphor-green: #4488FF;
  --phosphor-rgb:   68, 136, 255;
  --glow:           #4488FF;
}

/* Pink -- hot magenta, post-reconstruction */
.pink-shift {
  --phosphor-green: #FF2D9B;
  --phosphor-rgb:   255, 45, 155;
  --glow:           #FF2D9B;
}

/* Cyan -- ghost channel, cold precision */
.cyan-shift {
  --phosphor-green: #00F5D4;
  --phosphor-rgb:   0, 245, 212;
  --glow:           #00F5D4;
}

/* Red -- emergency/alert mode */
.red-shift {
  --phosphor-green: #FF3333;
  --phosphor-rgb:   255, 51, 51;
  --glow:           #FF3333;
}

/* CRITICAL: lock the page itself from ever scrolling */
*,
*::before,
*::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  -webkit-tap-highlight-color: transparent;
}

html {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: fixed;
  top: 0;
  left: 0;
  font-size: var(--text-base);   /* everything rem-based scales from here */
}

body {
  width: 100%;
  height: 100%;
  overflow: hidden;
  position: fixed;
  top: 0;
  left: 0;
  background: #000;
  color: var(--phosphor-green);
  font-family: 'VT323', monospace;
  font-size: var(--text-base);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Scanlines */
@keyframes scanlines-move {
  from { transform: translateY(-50%) translateZ(0); }
  to   { transform: translateY(0%)   translateZ(0); }
}

@-webkit-keyframes scanlines-move {
  from { -webkit-transform: translateY(-50%) translateZ(0); }
  to   { -webkit-transform: translateY(0%)   translateZ(0); }
}

.scanlines {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 200%;
  z-index: 999;
  pointer-events: none;
  background-image: repeating-linear-gradient(
    0deg,
    rgba(0, 0, 0, 0)    0px,
    rgba(0, 0, 0, 0.5)  1px,
    rgba(0, 0, 0, 0)    2px
  );
  animation: scanlines-move 10s linear infinite;
  -webkit-animation: scanlines-move 10s linear infinite;
  opacity: 0.6;
  will-change: transform;
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

/* Screen flicker */
@keyframes screen-flicker {
  0%,  100% { opacity: 1;    transform: translate(0,     0)     scale(1)     translateZ(0); }
  10%       { opacity: 0.93; transform: translate(-2px,  2px)   scale(1.002) translateZ(0); }
  20%       { opacity: 0.96; transform: translate( 2px, -2px)   scale(0.998) translateZ(0); }
  30%       { opacity: 0.94; transform: translate(-2px, -2px)   scale(1.002) translateZ(0); }
  40%       { opacity: 1;    transform: translate( 2px,  2px)   scale(0.998) translateZ(0); }
}

@-webkit-keyframes screen-flicker {
  0%,  100% { opacity: 1;    -webkit-transform: translate(0,     0)     scale(1)     translateZ(0); }
  10%       { opacity: 0.93; -webkit-transform: translate(-2px,  2px)   scale(1.002) translateZ(0); }
  20%       { opacity: 0.96; -webkit-transform: translate( 2px, -2px)   scale(0.998) translateZ(0); }
  30%       { opacity: 0.94; -webkit-transform: translate(-2px, -2px)   scale(1.002) translateZ(0); }
  40%       { opacity: 1;    -webkit-transform: translate( 2px,  2px)   scale(0.998) translateZ(0); }
}

.screen-content.glitch {
  animation: screen-flicker 0.2s ease !important;
  -webkit-animation: screen-flicker 0.2s ease !important;
}

/* RGB split glitch */
@keyframes rgb-split {
  0%,  100% { text-shadow: 0 0 2px var(--phosphor-green); }
  25%       { text-shadow: -3px 0 0 #ff0051,  3px 0 0 #00d4ff, 0 0 5px var(--phosphor-green); }
  50%       { text-shadow:  3px 0 0 #ff0051, -3px 0 0 #00d4ff, 0 0 5px var(--phosphor-green); }
  75%       { text-shadow: -2px 0 0 #ff0051,  2px 0 0 #00d4ff, 0 0 5px var(--phosphor-green); }
}

@-webkit-keyframes rgb-split {
  0%,  100% { text-shadow: 0 0 2px var(--phosphor-green); }
  25%       { text-shadow: -3px 0 0 #ff0051,  3px 0 0 #00d4ff, 0 0 5px var(--phosphor-green); }
  50%       { text-shadow:  3px 0 0 #ff0051, -3px 0 0 #00d4ff, 0 0 5px var(--phosphor-green); }
  75%       { text-shadow: -2px 0 0 #ff0051,  2px 0 0 #00d4ff, 0 0 5px var(--phosphor-green); }
}

.glitch-text {
  animation: rgb-split 0.3s ease !important;
  -webkit-animation: rgb-split 0.3s ease !important;
}

/* Status dot pulse */
@keyframes pulse {
  0%, 100% { opacity: 1; }
  50%       { opacity: 0.3; }
}

@-webkit-keyframes pulse {
  0%, 100% { opacity: 1; }
  50%       { opacity: 0.3; }
}

.status-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  background: var(--phosphor-green);
  border-radius: 50%;
  margin-right: 6px;
  box-shadow: 0 0 6px var(--phosphor-green);
  animation: pulse 2s ease-in-out infinite;
  -webkit-animation: pulse 2s ease-in-out infinite;
}

/* Cursor blink */
@keyframes blink {
  0%,  49% { opacity: 1; }
  50%, 100% { opacity: 0; }
}

@-webkit-keyframes blink {
  0%,  49% { opacity: 1; }
  50%, 100% { opacity: 0; }
}

.cursor {
  display: inline-block;
  width: 7px;
  height: 1em;
  background: var(--phosphor-green);
  margin-left: 3px;
  animation: blink 1s step-end infinite;
  -webkit-animation: blink 1s step-end infinite;
  vertical-align: text-bottom;
}

/* Scrollbar (only inside terminal pane) */
.shell-output::-webkit-scrollbar       { width: 4px; }
.shell-output::-webkit-scrollbar-track { background: transparent; }
.shell-output::-webkit-scrollbar-thumb { background: var(--phosphor-green); border-radius: 2px; }

/* Text glow */
.text-glow {
  text-shadow: 0 0 3px var(--phosphor-green);
}

.text-glow-strong {
  text-shadow:
    0 0 4px var(--phosphor-green),
    0 0 8px var(--phosphor-green);
}

/* ── CRT channel switch (CORE tab) ────────────────────────────────────────────
   Fast collapse to a line and expand — "changing the channel". ~220ms. */

@keyframes crt-channel-switch {
  0%   { transform: scaleY(1);     filter: brightness(1);   }
  30%  { transform: scaleY(0.04);  filter: brightness(3.5); }
  45%  { transform: scaleY(0.008); filter: brightness(7);   }
  55%  { transform: scaleY(0.008); filter: brightness(7);   }
  70%  { transform: scaleY(0.04);  filter: brightness(3.5); }
  100% { transform: scaleY(1);     filter: brightness(1);   }
}

.crt-channel-switch {
  transform-origin: center center;
  animation: crt-channel-switch 220ms ease-in-out forwards;
  overflow: hidden;
  pointer-events: none;
}

/* ── CRT static burst (SYNTHETICS / ANALOGUES / UPLINK tabs) ──────────────────
   Antenna interference — opacity strobe + horizontal jitter. ~180ms. */

@keyframes crt-static-burst {
  0%   { transform: translateX(0);    opacity: 1;    filter: brightness(1);   }
  10%  { transform: translateX(-4px); opacity: 0.4;  filter: brightness(2);   }
  20%  { transform: translateX( 5px); opacity: 0.85; filter: brightness(0.7); }
  30%  { transform: translateX(-3px); opacity: 0.3;  filter: brightness(2.5); }
  42%  { transform: translateX( 6px); opacity: 0.9;  filter: brightness(0.5); }
  55%  { transform: translateX(-2px); opacity: 0.5;  filter: brightness(1.8); }
  68%  { transform: translateX( 3px); opacity: 0.8;  filter: brightness(1);   }
  80%  { transform: translateX(-1px); opacity: 0.95; filter: brightness(1.1); }
  100% { transform: translateX(0);    opacity: 1;    filter: brightness(1);   }
}

.crt-static-burst {
  animation: crt-static-burst 180ms ease-out forwards;
  pointer-events: none;
}

/* ── CRT whiteout flash (telnet connected) ─────────────────────────────────────
   Electron beam reset — instant white spike, fast decay. ~300ms. */

@keyframes crt-whiteout-flash {
  0%   { filter: brightness(1)  saturate(1);   }
  8%   { filter: brightness(12) saturate(0);   }
  20%  { filter: brightness(5)  saturate(0.3); }
  45%  { filter: brightness(2)  saturate(0.7); }
  100% { filter: brightness(1)  saturate(1);   }
}

.crt-whiteout-flash {
  animation: crt-whiteout-flash 300ms ease-out forwards;
  pointer-events: none;
}

/* ── CRT desync tear (phosphor shift + hack complete) ──────────────────────────
   Horizontal sync loss — the screen warps like a bad VHS tracking signal.
   Combines skew + lateral displacement + hue rotation. ~350ms. */

@keyframes crt-desync-tear {
  0%   { transform: skewX(0deg)    translateX(0);    filter: hue-rotate(0deg)   brightness(1);   }
  8%   { transform: skewX(-4deg)   translateX(-8px); filter: hue-rotate(90deg)  brightness(1.5); }
  18%  { transform: skewX( 3deg)   translateX(12px); filter: hue-rotate(180deg) brightness(0.7); }
  28%  { transform: skewX(-2deg)   translateX(-6px); filter: hue-rotate(270deg) brightness(1.3); }
  40%  { transform: skewX( 1.5deg) translateX( 4px); filter: hue-rotate(180deg) brightness(1.1); }
  55%  { transform: skewX(-0.5deg) translateX(-2px); filter: hue-rotate(60deg)  brightness(1);   }
  70%  { transform: skewX( 0.2deg) translateX( 1px); filter: hue-rotate(20deg)  brightness(1);   }
  100% { transform: skewX(0deg)    translateX(0);    filter: hue-rotate(0deg)   brightness(1);   }
}

.crt-desync-tear {
  animation: crt-desync-tear 350ms ease-out forwards;
  pointer-events: none;
}

/* ── CRT power transition ──────────────────────────────────────────────────────
   Power-off: screen squishes to a bright horizontal line, then collapses to dark.
   Power-on:  line blooms from nothing, expands to fill the screen.
   Both use scaleY so the effect anchors to the vertical center of the terminal.
   filter:brightness spikes at near-zero scaleY to fake the phosphor afterglow. */

@keyframes crt-power-off {
  0%   { transform: scaleY(1);      filter: brightness(1);   }
  45%  { transform: scaleY(0.06);   filter: brightness(2.2); }
  65%  { transform: scaleY(0.015);  filter: brightness(6);   }
  80%  { transform: scaleY(0.006);  filter: brightness(3.5); }
  100% { transform: scaleY(0);      filter: brightness(0);   }
}

@keyframes crt-power-on {
  0%   { transform: scaleY(0);      filter: brightness(0);   }
  12%  { transform: scaleY(0.006);  filter: brightness(9);   }
  28%  { transform: scaleY(0.04);   filter: brightness(4);   }
  58%  { transform: scaleY(1);      filter: brightness(1.6); }
  100% { transform: scaleY(1);      filter: brightness(1);   }
}

.crt-powering-off {
  transform-origin: center center;
  animation: crt-power-off 450ms ease-in forwards;
  overflow: hidden;
}

.crt-powering-on {
  transform-origin: center center;
  animation: crt-power-on 580ms ease-out forwards;
  overflow: hidden;
}

/* iOS: force GPU layers on animated elements */
@supports (-webkit-touch-callout: none) {
  .scanlines,
  .screen-content {
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }
}
